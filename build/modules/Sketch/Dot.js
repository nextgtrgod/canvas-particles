import f from"../../utils/getDistance.js";const u=2*Math.PI;let t=0,e=0;class a{constructor({id:i,x:s,y:h,r:n,v:y,fill:l="#F0F0F0",type:c}){this.id=i,this.x=s,this.y=h,this.r=n,this.v=y,this.fill=l,this.type=c,this.type==="static"&&(this.update=this.draw),this.lines={},this.bounds={top:0,right:0,bottom:0,left:0},this.updateBounds()}checkOffscreen(i,s){this.bounds.left<=0&&this.v.x<=0?this.v.x*=-1:this.bounds.right>=i&&this.v.x>=0&&(this.v.x*=-1),this.bounds.top<=0&&this.v.y<=0?this.v.y*=-1:this.bounds.bottom>=s&&this.v.y>=0&&(this.v.y*=-1)}updateBounds(){this.bounds.top=this.y-this.r,this.bounds.right=this.x+this.r,this.bounds.bottom=this.y+this.r,this.bounds.left=this.x-this.r}checkDots(i,s){for(t=0;t<i.length;t++){if(i[t].id===this.id)continue;if(i[t].lines[this.id])continue;if(e=f(this.x,this.y,i[t].x,i[t].y),e<=this.r+i[t].r){if(i[t].type==="static"){this.v.x*=-1,this.v.y*=-1;continue}let h=[{x:this.v.x,y:this.v.y},{x:i[t].v.x,y:i[t].v.y}];this.v.x=h[1].x,this.v.y=h[1].y,i[t].v.x=h[0].x,i[t].v.y=h[0].y;continue}if(i[t].type==="static")continue;e<=s?this.lines[i[t].id]={0:{x:this.x,y:this.y},1:{x:i[t].x,y:i[t].y},alpha:(s-e)/(s/2),width:Math.min(s/e,Math.min(this.r,i[t].r)/2)}:delete this.lines[i[t].id]}}update(i,s,h,n,y){this.x+=this.v.x||0,this.y+=this.v.y||0,this.checkOffscreen(s,h),this.updateBounds(),this.checkDots(n,y),this.draw(i)}draw(i){i.beginPath(),i.fillStyle=this.fill,i.arc(this.x,this.y,this.r,0,u),i.fill()}}export default a;
